object frmRatingMgr: TfrmRatingMgr
  Left = 0
  Top = 0
  Caption = #44060#48324#54217#44032#44288#47532
  ClientHeight = 556
  ClientWidth = 866
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  PixelsPerInch = 96
  TextHeight = 13
  object Panel1: TPanel
    Left = 0
    Top = 0
    Width = 457
    Height = 556
    Align = alLeft
    Padding.Left = 3
    Padding.Top = 3
    Padding.Right = 3
    Padding.Bottom = 3
    TabOrder = 0
    ExplicitTop = -135
    ExplicitHeight = 691
    object Panel2: TPanel
      Left = 4
      Top = 4
      Width = 449
      Height = 60
      Align = alTop
      BevelOuter = bvNone
      TabOrder = 0
      object Label2: TLabel
        Left = 192
        Top = 35
        Width = 24
        Height = 13
        Caption = #44160#49353
      end
      object Label3: TLabel
        Left = 58
        Top = 35
        Width = 48
        Height = 13
        Caption = #44160#49353#51312#44148
      end
      object cxLabel1: TcxLabel
        Left = 16
        Top = 7
        Caption = #48337#46041
        Transparent = True
      end
      object cboWard: TcxComboBox
        Left = 44
        Top = 5
        Properties.DropDownListStyle = lsFixedList
        TabOrder = 1
        Width = 121
      end
      object rIn: TcxRadioButton
        Left = 196
        Top = 7
        Width = 53
        Height = 17
        Caption = #51077#50896
        Checked = True
        TabOrder = 2
        TabStop = True
        Transparent = True
      end
      object btnSearch: TcxButton
        Left = 354
        Top = 28
        Width = 67
        Height = 28
        Caption = #44160#49353
        Glyph.Data = {
          36040000424D3604000000000000360000002800000010000000100000000100
          2000000000000004000000000000000000000000000000000000000000000000
          0000000000000000000000000000000000000000000000000000000000000000
          0000000000000000000000000000442F005F3827004F00000000000000000000
          0000000000000000000000000000000000000000000000000000000000000000
          000000000000000000002D1F003FB67E00FFB67E00FF2D1F003F000000000000
          000000000000000000005B4D2E6EB38D37E6B67E01FFB67E01FFBB8A1DFBAC89
          3ADB302A1A3A0B07000F9F6E00DFB67E00FF9F6E00DF22180030000000000000
          000018150E1DB38D37E6BA8611FFD2B36BFFEADFC4FFEDE3CDFFDDC693FFC59A
          39FFB78004FFA87D1BE2B67E00FF7D5600AF0B08001000000000000000000000
          0000B38D37E6C19229FFEEE5D1FFF8F8F8FFF8F7F5FFF7F5EEFFF7F6EFFFF7F6
          F3FFE5D5B0FFBB8713FFA37D27D6000000000000000000000000000000005B4E
          2F6EBD8A19FFF2EDE2FFF8F8F8FFF7F5EEFFF6F1DFFFF5EFD6FFF5EFD6FFF6F1
          E0FFF7F6EFFFE5D5B0FFB77F03FF302A1A3A000000000000000000000000B28C
          37E5D5B673FFF8F8F8FFF8F7F5FFF6F1DFFFF4ECCBFFF3E8BEFFF3E9BFFFF4EC
          CCFFF6F1E0FFF7F6F3FFC59A39FFAB893BDA000000000000000000000000B77F
          03FFEDE3CEFFF8F8F8FFF7F5EEFFF5EFD5FFF3E8BEFFF1E3A8FFF1E3A9FFF3E9
          BFFFF5EFD6FFF7F6EFFFDDC794FFBB8A1DFB000000000000000000000000B77F
          03FFF2EDE1FFF8F8F8FFF7F5EEFFF5EFD5FFF3E8BDFFF1E2A8FFF1E3A8FFF3E8
          BEFFF5EFD6FFF7F5EEFFEDE3CEFFB67E01FF000000000000000000000000BB8B
          1FFBE5D4AFFFF8F8F8FFF8F7F5FFF6F1DFFFF4ECCBFFF3E8BDFFF3E8BEFFF4EC
          CBFFF6F1DFFFF8F7F5FFE7D9BAFFB67E01FF000000000000000000000000AC89
          3CDACDA855FFF8F8F8FFF8F8F8FFF7F5EEFFF6F1DFFFF5EFD5FFF5EFD5FFF6F1
          DFFFF7F5EEFFF8F8F8FFD0AF63FFB38C35E6000000000000000000000000322B
          1B3CB9840DFFECE2CAFFF8F8F8FFF8F8F8FFF8F7F5FFF7F5EEFFF7F5EEFFF8F7
          F5FFF8F8F8FFEEE5D1FFBA8610FF5C4F2F700000000000000000000000000000
          0000997D3FBFBE8D1EFFEBE0C6FFF8F8F8FFF8F8F8FFF8F8F8FFF8F8F8FFF8F8
          F8FFF3EFE6FFC69B3AFFB38D37E6000000000000000000000000000000000000
          000000000000997D3FBFBB8813FFCDA958FFE7D9B9FFF3EEE4FFECE2CAFFD6B9
          79FFBA8611FFB38C35E619160F1E000000000000000000000000000000000000
          00000000000000000000322B1B3CAC893ADBBB8B1FFBB77F02FFB77F02FFB38D
          37E65C4F2F700000000000000000000000000000000000000000000000000000
          0000000000000000000000000000000000000000000000000000000000000000
          0000000000000000000000000000000000000000000000000000}
        LookAndFeel.SkinName = 'Caramel'
        SpeedButtonOptions.Transparent = True
        TabOrder = 3
      end
      object rOut: TcxRadioButton
        Left = 250
        Top = 7
        Width = 53
        Height = 17
        Caption = #53748#50896
        TabOrder = 4
        Transparent = True
      end
      object rAll: TcxRadioButton
        Left = 305
        Top = 7
        Width = 53
        Height = 17
        Caption = #51204#52404
        TabOrder = 5
        Transparent = True
      end
      object cboSearchCondition: TcxComboBox
        Left = 106
        Top = 30
        Properties.DropDownListStyle = lsFixedList
        Properties.Items.Strings = (
          #51060#47492
          #48264#54840)
        TabOrder = 6
        Text = #51060#47492
        Width = 59
      end
      object txtSearch: TcxTextEdit
        Left = 216
        Top = 30
        Style.HotTrack = False
        Style.LookAndFeel.SkinName = 'Caramel'
        StyleDisabled.LookAndFeel.SkinName = 'Caramel'
        StyleFocused.LookAndFeel.SkinName = 'Caramel'
        StyleHot.LookAndFeel.SkinName = 'Caramel'
        TabOrder = 7
        Width = 135
      end
    end
    object cxGrid1: TcxGrid
      Left = 4
      Top = 64
      Width = 449
      Height = 488
      Align = alClient
      TabOrder = 1
      ExplicitHeight = 567
      object cxGInOut: TcxGridDBTableView
        DataController.DataSource = dsInOut
        DataController.Summary.DefaultGroupSummaryItems = <>
        DataController.Summary.FooterSummaryItems = <>
        DataController.Summary.SummaryGroups = <>
        OptionsData.Deleting = False
        OptionsData.Editing = False
        OptionsData.Inserting = False
        OptionsView.GroupByBox = False
        OptionsView.Indicator = True
        object cxGInOutPatientID: TcxGridDBColumn
          Caption = #54872#51088#48264#54840
          DataBinding.FieldName = 'PatientID'
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Width = 62
        end
        object cxGInOutPatientName: TcxGridDBColumn
          Caption = #54872#51088#49457#47749
          DataBinding.FieldName = 'PatientName'
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Width = 59
        end
        object cxGInOutSEX: TcxGridDBColumn
          Caption = #49457#48324
          DataBinding.FieldName = 'SEX'
          PropertiesClassName = 'TcxLabelProperties'
          Properties.Alignment.Horz = taCenter
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 29
        end
        object cxGInOutBIRTHDAY: TcxGridDBColumn
          Caption = #49373#45380#50900#51068
          DataBinding.FieldName = 'BIRTHDAY'
          PropertiesClassName = 'TcxLabelProperties'
          Properties.Alignment.Horz = taCenter
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
        end
        object cxGInOutStateName: TcxGridDBColumn
          Caption = #49345#53468
          DataBinding.FieldName = 'StateName'
          PropertiesClassName = 'TcxLabelProperties'
          Properties.Alignment.Horz = taCenter
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 34
        end
        object cxGInOutInDate: TcxGridDBColumn
          Caption = #51077#50896#51068#51088
          DataBinding.FieldName = 'InDate'
          HeaderAlignmentHorz = taCenter
        end
        object cxGInOutOutDate: TcxGridDBColumn
          Caption = #53748#50896#51068#51088
          DataBinding.FieldName = 'OutDate'
          PropertiesClassName = 'TcxLabelProperties'
          Properties.Alignment.Horz = taCenter
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
        end
        object cxGInOutDiagName: TcxGridDBColumn
          Caption = #51652#45800#47749
          DataBinding.FieldName = 'DiagName'
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 192
        end
        object cxGInOutWardName: TcxGridDBColumn
          Caption = #48337#46041
          DataBinding.FieldName = 'WardName'
          PropertiesClassName = 'TcxLabelProperties'
          Properties.Alignment.Horz = taCenter
          HeaderAlignmentHorz = taCenter
          HeaderGlyphAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 46
        end
        object cxGInOutUserID: TcxGridDBColumn
          Caption = #48373#51648#49324
          DataBinding.FieldName = 'UserName'
          PropertiesClassName = 'TcxLabelProperties'
          Properties.Alignment.Horz = taCenter
          Visible = False
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 55
        end
        object cxGInOutDoctorID: TcxGridDBColumn
          Caption = #51204#47928#51032
          DataBinding.FieldName = 'DoctorName'
          PropertiesClassName = 'TcxLabelProperties'
          Properties.Alignment.Horz = taCenter
          Visible = False
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 38
        end
        object cxGInOutUsed: TcxGridDBColumn
          DataBinding.FieldName = 'Used'
          Visible = False
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 42
        end
        object cxGInOutHospitalID: TcxGridDBColumn
          DataBinding.FieldName = 'HospitalID'
          Visible = False
        end
        object cxGInOutState: TcxGridDBColumn
          DataBinding.FieldName = 'State'
          Visible = False
        end
        object cxGInOutWardID: TcxGridDBColumn
          DataBinding.FieldName = 'WardID'
          Visible = False
        end
        object cxGInOutUserID1: TcxGridDBColumn
          DataBinding.FieldName = 'UserID'
          Visible = False
        end
        object cxGInOutDoctorID1: TcxGridDBColumn
          DataBinding.FieldName = 'DoctorID'
          Visible = False
        end
        object cxGInOutHospitalID_1: TcxGridDBColumn
          DataBinding.FieldName = 'HospitalID_1'
          Visible = False
        end
        object cxGInOutPatientID_1: TcxGridDBColumn
          DataBinding.FieldName = 'PatientID_1'
          Visible = False
        end
        object cxGInOutUsed_1: TcxGridDBColumn
          DataBinding.FieldName = 'Used_1'
          Visible = False
        end
        object cxGInOutintake: TcxGridDBColumn
          DataBinding.FieldName = 'intake'
          PropertiesClassName = 'TcxCheckBoxProperties'
          Properties.NullStyle = nssUnchecked
          Visible = False
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 36
        end
        object cxGInOutsurvey1: TcxGridDBColumn
          Caption = #51312#49324'I'
          DataBinding.FieldName = 'survey1'
          PropertiesClassName = 'TcxCheckBoxProperties'
          Properties.NullStyle = nssUnchecked
          Visible = False
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 36
        end
        object cxGInOutsurvey2: TcxGridDBColumn
          Caption = #51312#49324'II'
          DataBinding.FieldName = 'survey2'
          PropertiesClassName = 'TcxCheckBoxProperties'
          Properties.NullStyle = nssUnchecked
          Visible = False
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 38
        end
        object cxGInOutBed: TcxGridDBColumn
          DataBinding.FieldName = 'Bed'
          Visible = False
        end
        object cxGInOutcounseling: TcxGridDBColumn
          Caption = #51648#46020
          DataBinding.FieldName = 'counseling'
          PropertiesClassName = 'TcxLabelProperties'
          Properties.Alignment.Horz = taCenter
          Visible = False
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 36
        end
        object cxGInOuttraining: TcxGridDBColumn
          Caption = #54984#47144
          DataBinding.FieldName = 'training'
          PropertiesClassName = 'TcxLabelProperties'
          Properties.Alignment.Horz = taCenter
          Visible = False
          HeaderAlignmentHorz = taCenter
          Options.Editing = False
          Options.Filtering = False
          Options.Sorting = False
          Width = 37
        end
      end
      object cxGrid1DBBandedTableView1: TcxGridDBBandedTableView
        DataController.DataSource = dsInOut
        DataController.Summary.DefaultGroupSummaryItems = <>
        DataController.Summary.FooterSummaryItems = <>
        DataController.Summary.SummaryGroups = <>
        Bands = <
          item
          end>
      end
      object cxGrid1DBTableView1: TcxGridDBTableView
        DataController.DataSource = dsInOut
        DataController.Summary.DefaultGroupSummaryItems = <>
        DataController.Summary.FooterSummaryItems = <>
        DataController.Summary.SummaryGroups = <>
      end
      object cxGrid1Level1: TcxGridLevel
        GridView = cxGInOut
      end
    end
  end
  object adoInOut: TADOQuery
    Connection = dbMain.adoSocialWorkDB
    CursorType = ctStatic
    Parameters = <
      item
        Name = 'state'
        Attributes = [paSigned, paNullable]
        DataType = ftInteger
        Precision = 10
        Size = 4
        Value = 0
      end
      item
        Name = 'WardID'
        Attributes = [paSigned]
        DataType = ftInteger
        Precision = 10
        Size = 4
        Value = 1
      end>
    SQL.Strings = (
      'select *'
      '       , case inout.state when 0 then '#39#51077#50896#39
      '                          when 1 then '#39#53748#50896#39
      '                          else '#39#50640#47084#39
      '         end as StateName'
      
        '       ,(select UserName from users where hospitalid=0 and useri' +
        'd=inout.UserID and Worker=1) as UserName'
      
        '       ,(select UserName from users where hospitalid=0 and useri' +
        'd=inout.DoctorID and Doctor=1) as DoctorName'
      '       , (select WardName from Wards'
      
        '                         where wards.wardid=inout.wardid) as War' +
        'dName'
      '       , (select count(*) from intake'
      '                  where inout.hospitalid=intake.hospitalid'
      '                    and inout.patientid=intake.patientid'
      '                    and inout.indate=intake.indate) as intake'
      '       , (select count(*) from survey1'
      '                  where inout.hospitalid=survey1.hospitalid'
      '                    and inout.patientid=survey1.patientid'
      '                    and inout.indate=survey1.indate) as survey1'
      '       , (select count(*) from survey2'
      '                  where inout.hospitalid=survey2.hospitalid'
      '                    and inout.patientid=survey2.patientid'
      '                    and inout.indate=survey2.indate) as survey2'
      '       , (select count(*) from counseling'
      '                  where inout.hospitalid=counseling.hospitalid'
      '                    and inout.patientid=counseling.patientid'
      
        '                    and inout.indate=counseling.indate) as couns' +
        'eling'
      '       , (select count(*) from training'
      '                  where inout.hospitalid=training.hospitalid'
      '                    and inout.patientid=training.patientid'
      
        '                    and inout.indate=training.indate) as trainin' +
        'g'
      '  from inout, patients'
      ' where inout.hospitalid=patients.hospitalid'
      '   and inout.patientid=patients.patientid'
      '   and state=:state'
      '   and WardID=:WardID'
      '   and inout.used=1 and patients.used=1'
      ' order by inout.patientid')
    Left = 110
    Top = 106
  end
  object dsInOut: TDataSource
    DataSet = adoInOut
    Left = 36
    Top = 106
  end
end
